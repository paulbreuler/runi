@import 'tailwindcss';

@import 'tw-animate-css';

/* ============================================
   runi Design System
   Based on basestate.io styling approach
   ============================================ */

@theme {
  /* Typography */
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', ui-monospace, monospace;

  /* Background Colors - Dark Mode (default) */
  --color-bg-app: #0a0a0a;
  --color-bg-surface: #141414;
  --color-bg-raised: #1e1e1e;
  --color-bg-elevated: #262626;

  /* Text Colors */
  --color-text-primary: #f5f5f5;
  --color-text-secondary: #a3a3a3;
  --color-text-muted: #636363;

  /* Border Colors */
  --color-border-subtle: #1e1e1e;
  --color-border-default: #2e2e2e;
  --color-border-emphasis: #404040;

  /* Accent Colors - runi palette - using oklch for opacity modifier support */
  --color-accent-blue: oklch(0.623 0.214 259.1);
  --color-accent-blue-hover: oklch(0.546 0.245 262.9);
  --color-accent-purple: oklch(0.627 0.265 303.9);
  --color-accent-green: oklch(0.723 0.191 142.5);
  --color-accent-amber: oklch(0.769 0.188 70.08);
  --color-accent-red: oklch(0.637 0.237 25.33);

  /* HTTP Method Colors - Industry Standard
   * GET: Blue (read, safe, neutral)
   * POST: Green (create, positive action)
   * PUT/PATCH: Orange/Yellow (update, caution)
   * DELETE: Red (destructive, warning)
   * HEAD/OPTIONS: Gray (meta, less frequent)
   */
  --color-method-get: oklch(0.623 0.214 259.1); /* Blue - accent-blue */
  --color-method-post: oklch(0.723 0.191 142.5); /* Green - signal-success */
  --color-method-put: oklch(0.769 0.188 70.08); /* Orange - signal-warning */
  --color-method-patch: oklch(0.769 0.188 70.08); /* Orange - same as PUT */
  --color-method-delete: oklch(0.637 0.237 25.33); /* Red - signal-error */
  --color-method-head: oklch(0.5 0 0); /* Gray - text-muted */
  --color-method-options: oklch(0.5 0 0); /* Gray - same as HEAD */

  /* Signal Colors - using oklch for opacity modifier support */
  --color-signal-success: oklch(0.723 0.191 142.5);
  --color-signal-warning: oklch(0.769 0.188 70.08);
  --color-signal-error: oklch(0.637 0.237 25.33);
  --color-signal-ai: oklch(0.627 0.265 303.9);

  /* Legacy shadcn/ui compatibility - mapped to new semantic names */
  --color-background: var(--color-bg-app);
  --color-foreground: var(--color-text-primary);
  --color-card: var(--color-bg-surface);
  --color-card-foreground: var(--color-text-primary);
  --color-popover: var(--color-bg-surface);
  --color-popover-foreground: var(--color-text-primary);
  --color-primary: var(--color-accent-blue);
  --color-primary-foreground: #ffffff;
  --color-secondary: var(--color-bg-raised);
  --color-secondary-foreground: var(--color-text-primary);
  --color-muted: var(--color-bg-raised);
  --color-muted-foreground: var(--color-text-secondary);
  --color-accent: var(--color-bg-raised);
  --color-accent-foreground: var(--color-text-primary);
  --color-destructive: var(--color-signal-error);
  --color-border: var(--color-border-default);
  --color-input: var(--color-bg-raised);
  --color-ring: var(
    --color-accent-blue
  ); /* Default fallback - components should use accent-blue explicitly */
}

/* ============================================
   Base Styles
   ============================================ */

html {
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-sans);
  background-color: var(--color-bg-app);
  color: var(--color-text-primary);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

@layer base {
  * {
    @apply border-border-default outline-ring/50;
  }
}

/* ============================================
   Animations
   ============================================ */

@keyframes pulse-glow {
  0%,
  100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.7;
    transform: scale(1.02);
  }
}

@keyframes slide-in {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fade-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-slide-in {
  animation: slide-in 0.3s ease-out forwards;
}

.animate-fade-up {
  animation: fade-up 0.6s ease-out forwards;
}

/* ============================================
   Scrollbar Styling
   ============================================ */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-bg-surface);
}

::-webkit-scrollbar-thumb {
  background: var(--color-border-emphasis);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

/* Hide scrollbars while preserving scroll behavior */
.scrollbar-hidden {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.scrollbar-hidden::-webkit-scrollbar {
  width: 0;
  height: 0;
}

/* Prevent scrollbar flashing during drag/resize operations */
/* Reserve space for scrollbars to prevent layout shifts */
[data-testid='request-pane'],
[data-testid='response-pane'],
[data-testid='pane-container'] {
  scrollbar-gutter: stable;
  /* Use overlay scrollbars on macOS to prevent flashing */
  scrollbar-width: thin;
  /* Prevent layout thrashing during drag */
  contain: layout style;
}

/* Ensure scrollable content areas maintain stable scrollbars */
[data-testid='request-pane'] > *,
[data-testid='response-pane'] > * {
  scrollbar-gutter: stable;
}

/* Prevent scrollbar flashing during sidebar resize */
aside[data-testid='sidebar'] {
  scrollbar-gutter: stable;
}

/* Prevent scrollbar flashing during drag/resize operations */
.scroll-container,
[data-testid='request-pane'],
[data-testid='response-pane'],
[data-testid='pane-container'] {
  scrollbar-gutter: stable;
  /* Reserve space for scrollbar to prevent layout shifts */
}

/* Ensure scrollbars don't flash during layout animations */
[data-testid='request-pane'] *,
[data-testid='response-pane'] * {
  scrollbar-gutter: stable;
}

/* Prevent text color/rendering changes during resize */
/* This fixes subpixel rendering artifacts that can cause text color shifts */
[data-testid='request-pane'],
[data-testid='response-pane'] {
  /* Disable color transitions on text elements during resize */
  /* Only allow transitions on hover/focus, not during layout changes */
}

/* Ensure text elements don't transition color during layout changes */
[data-testid='request-pane'] *,
[data-testid='response-pane'] * {
  /* Text color transitions should only occur on hover/focus, not layout changes */
  /* This prevents color shifts during resize operations */
}

/* ============================================
   Selection
   ============================================ */

::selection {
  background: oklch(0.623 0.214 259.1 / 0.3); /* accent-blue with 30% opacity */
  color: var(--color-text-primary);
}

/* ============================================
   Code Snippet - Line Number Selection Prevention
   ============================================ */

.code-snippet-wrapper .token-line > span:first-child,
.code-snippet-wrapper span[class*='linenumber'] {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  pointer-events: none;
}
