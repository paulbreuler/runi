/**
 * Copyright (c) 2026 BaseState LLC
 * SPDX-License-Identifier: MIT
 *
 * runi Design System
 * Based on Radix Themes 3 architecture with Tailwind CSS utilities
 */

/* ============================================
   Radix Color Scales (raw values)
   ============================================ */
@import './styles/radix-colors.css';

/* ============================================
   Theme Token Mappings (data attribute selectors)
   ============================================ */
@import './styles/theme-tokens.css';

/* ============================================
   Tailwind CSS
   ============================================ */
@import 'tailwindcss';
@import 'tw-animate-css';

/* ============================================
   Tailwind Theme Extensions
   ============================================ */
@theme {
  /* Typography */
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', ui-monospace, monospace;

  /* Signal Colors (runi-specific, until full Radix scales added) */
  --color-signal-success: oklch(0.723 0.191 142.5);
  --color-signal-warning: oklch(0.769 0.188 70.08);
  --color-signal-error: oklch(0.637 0.237 25.33);
  --color-signal-ai: oklch(0.627 0.265 303.9);

  /* HTTP Method Colors */
  --color-method-get: var(--accent-9);
  --color-method-post: var(--color-signal-success);
  --color-method-put: var(--color-signal-warning);
  --color-method-patch: var(--color-signal-warning);
  --color-method-delete: var(--color-signal-error);
  --color-method-head: var(--gray-9);
  --color-method-options: var(--gray-9);

  /* Accent Colors (for Tailwind utility compatibility) */
  --color-accent-purple: oklch(0.627 0.265 303.9);
  --color-accent-green: oklch(0.723 0.191 142.5);
  --color-accent-amber: oklch(0.769 0.188 70.08);
  --color-accent-red: oklch(0.637 0.237 25.33);

  /* shadcn/ui compatibility layer */
  --color-foreground: var(--gray-12);
  --color-card: var(--color-surface);
  --color-card-foreground: var(--gray-12);
  --color-popover: var(--color-surface);
  --color-popover-foreground: var(--gray-12);
  --color-primary: var(--accent-9);
  --color-primary-foreground: var(--accent-contrast);
  --color-secondary: var(--color-panel-solid);
  --color-secondary-foreground: var(--gray-12);
  --color-muted: var(--color-panel-solid);
  --color-muted-foreground: var(--gray-11);
  --color-accent: var(--color-panel-solid);
  --color-accent-foreground: var(--gray-12);
  --color-destructive: var(--color-signal-error);
  --color-border: var(--gray-6);
  --color-input: var(--color-panel-solid);
  --color-ring: var(--focus-8);
}

/* ============================================
   Base Styles
   ============================================ */

html {
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-sans);
  background-color: var(--color-background);
  color: var(--gray-12);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

@layer base {
  * {
    @apply border-[var(--gray-6)] outline-[var(--focus-8)]/50;
  }
}

/* ============================================
   Animations
   ============================================ */

@keyframes pulse-glow {
  0%,
  100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.7;
    transform: scale(1.02);
  }
}

@keyframes slide-in {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fade-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-slide-in {
  animation: slide-in 0.3s ease-out forwards;
}

.animate-fade-up {
  animation: fade-up 0.6s ease-out forwards;
}

/* ============================================
   Scrollbar Styling
   ============================================ */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-surface);
}

::-webkit-scrollbar-thumb {
  background: var(--gray-8);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--gray-9);
}

/* Hide scrollbars while preserving scroll behavior */
.scrollbar-hidden {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.scrollbar-hidden::-webkit-scrollbar {
  width: 0;
  height: 0;
}

/* Prevent scrollbar flashing during drag/resize operations */
/* Reserve space for scrollbars to prevent layout shifts */
[data-testid='request-pane'],
[data-testid='response-pane'],
[data-testid='pane-container'] {
  scrollbar-gutter: stable;
  /* Use overlay scrollbars on macOS to prevent flashing */
  scrollbar-width: thin;
  /* Prevent layout thrashing during drag */
  contain: layout style;
}

/* Ensure scrollable content areas maintain stable scrollbars */
[data-testid='request-pane'] > *,
[data-testid='response-pane'] > * {
  scrollbar-gutter: stable;
}

/* Prevent scrollbar flashing during sidebar resize */
aside[data-testid='sidebar'] {
  scrollbar-gutter: stable;
}

/* Prevent scrollbar flashing during drag/resize operations */
.scroll-container,
[data-testid='request-pane'],
[data-testid='response-pane'],
[data-testid='pane-container'] {
  scrollbar-gutter: stable;
  /* Reserve space for scrollbar to prevent layout shifts */
}

/* Ensure scrollbars don't flash during layout animations */
[data-testid='request-pane'] *,
[data-testid='response-pane'] * {
  scrollbar-gutter: stable;
}

/* Prevent text color/rendering changes during resize */
/* This fixes subpixel rendering artifacts that can cause text color shifts */
[data-testid='request-pane'],
[data-testid='response-pane'] {
  /* Disable color transitions on text elements during resize */
  /* Only allow transitions on hover/focus, not during layout changes */
}

/* Ensure text elements don't transition color during layout changes */
[data-testid='request-pane'] *,
[data-testid='response-pane'] * {
  /* Text color transitions should only occur on hover/focus, not layout changes */
  /* This prevents color shifts during resize operations */
}

/* ============================================
   Selection
   ============================================ */

::selection {
  background: var(--accent-a5);
  color: var(--gray-12);
}

/* ============================================
   Code Snippet - Line Number Selection Prevention
   ============================================ */

.code-snippet-wrapper .token-line > span:first-child,
.code-snippet-wrapper span[class*='linenumber'] {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  pointer-events: none;
}

/* ============================================
   Code Snippet - Line Number Left Spacing
   ============================================ */

/* Remove left padding from container when it contains line numbers */
/* This overrides the px-2 padding on borderless variant */
/*
 * Note: !important is necessary here because we need to override Tailwind's utility classes
 * (px-2) when line numbers are present. The :has() selector provides specificity but
 * Tailwind's utility classes have high specificity, so !important is required to ensure
 * the override takes effect. This is a targeted override for a specific UI state.
 */
[data-language]:has(.code-snippet-wrapper .react-syntax-highlighter-line-number),
[data-language]:has(.code-snippet-wrapper span[class*='linenumber']) {
  padding-left: 0 !important;
}

/* Remove left padding from ResponseViewer body container when it contains line numbers */
[data-testid='response-body']:has(.code-snippet-wrapper .react-syntax-highlighter-line-number),
[data-testid='response-body']:has(.code-snippet-wrapper span[class*='linenumber']) {
  padding-left: 0 !important;
}

/* Remove left padding/margin from react-syntax-highlighter line number containers */
/* Target all possible structures: table-based and span-based line numbers */
.code-snippet-wrapper table[class*='react-syntax-highlighter'],
.code-snippet-wrapper table[class*='react-syntax-highlighter'] td:first-child,
.code-snippet-wrapper span[class*='react-syntax-highlighter-line-number'],
.code-snippet-wrapper span[class*='linenumber'],
.code-snippet-wrapper .react-syntax-highlighter-line-number,
/* Also apply to BodyEditor and other direct SyntaxHighlighter usage */
[data-testid='body-syntax-layer'] table[class*='react-syntax-highlighter'],
[data-testid='body-syntax-layer'] table[class*='react-syntax-highlighter'] td:first-child,
[data-testid='body-syntax-layer'] span[class*='react-syntax-highlighter-line-number'],
[data-testid='body-syntax-layer'] span[class*='linenumber'],
[data-testid='body-syntax-layer'] .react-syntax-highlighter-line-number,
/* General selectors for any SyntaxHighlighter usage */
span[class*='react-syntax-highlighter-line-number'],
span[class*='linenumber'],
.react-syntax-highlighter-line-number {
  padding-left: 0 !important;
  margin-left: 0 !important;
}

/* Also target the pre/code containers that might have default padding */
.code-snippet-wrapper pre[class*='language-'],
.code-snippet-wrapper code[class*='language-'],
.code-snippet-wrapper div[class*='language-'],
[data-testid='body-syntax-layer'] pre[class*='language-'],
[data-testid='body-syntax-layer'] code[class*='language-'],
[data-testid='body-syntax-layer'] div[class*='language-'] {
  padding-left: 0;
}
